<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title><%= title %></title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/header.css" rel="stylesheet">
    <!-- start Mixpanel --><script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
            0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
            for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
        mixpanel.init("c7c569d0adcc1f4cc5a52fbc9002a43e");</script><!-- end Mixpanel -->
</head>
<header>
    <div class="container col-md-12" style="text-align: center;">
        <img class="logo" style="height: 100px;padding-top:20px;" src="/images/empiricalhire.png" />
    </div>
    <div class="container col-md-12">
        <h1><%= subTitle %></h1>
    </div>
</header>
<body>
    <div id="formContainer" class="container" style="scroll:hidden;overflow: auto; height: 450px;width:100%;">
        <form id="addCandidate" method="post" action=<%='/clients/' + client._id + '/addCandidate'%>>
    <div class="container inputField" style="padding-top: 10px;font-weight: 600;color: black;/*font-size: medium;*/">
        <div id="inputname"  style="padding-top: 20px;">
            <input id="user_name" class="inputs" name="user_fullName" type="text" placeholder='<%= fieldNames.nameField %>' style="border-style: none none solid none;text-align: center;opacity: 0.7;">
        </div>
        <div id="inputphone" style="padding-top: 20px;">
            <input id="user_tel" class="inputs" name="user_tel" type="text" placeholder='<%= fieldNames.phoneField %>' style="border-style: none none solid none;text-align: center;opacity: 0.7">
        </div>
        <div id="inputid" style="padding-top: 20px;">
            <input id="user_id" class="inputs" name="user_id" type="text" placeholder='<%= fieldNames.idField %>' style="border-style: none none solid none;text-align: center;opacity: 0.7;">
        </div>
        <div id="inputemail" style="padding-top: 20px;">
            <input id="user_email" class="inputs" name="user_email" type="email" placeholder='<%= fieldNames.emailField %>' style="border-style: none none solid none;text-align: center;opacity: 0.7">
        </div>
        <div id="inputRecruitmentSource"  style="padding-top: 20px;">
            <input id="recruitmentSource" class="inputs" name="recruitmentSource" type="text" placeholder='<%= fieldNames.recruitmentSourcelField %>' style="border-style: none none solid none;text-align: center;opacity: 0.7;">
        </div>
        <div id="inputLinkToCV"  style="padding-top: 20px;">
            <input id="linkToCV" class="inputs" name="linkToCV" type="text" placeholder='<%= fieldNames.linkToCVField %>' style="border-style: none none solid none;text-align: center;opacity: 0.7;">
        </div>
        <div id="clientLanguage" class="btn-group" style="padding: 20px;display:inline-block;">
            <!-- The label has to come before (to the left) of the radio button. Otherwise in RTL (Hebrew) the label gets attached to the wrong button -->
            <label for="input-male" style="padding-right: 10px"><%= fieldNames.maleText %></label><input class="inputs" name="gender" type="radio" id="input-male"
                   value="male" style="border-style: none none solid none;text-align: center;opacity: 0.7;">


            <label for="input-female" style="padding-right: 10px"><%= fieldNames.femaleText %></label><input class="inputs" name="gender" type="radio" id="input-female"
                   value="female" style="border-style: none none solid none;text-align: center;opacity: 0.7;">

        </div>
    </div>
            <div class="col-md-12 container" style="padding-top: 50px; padding-bottom: 50px;">
                <button href="/addCandidate" id="submit" name="submit_btn" style="width: 200px;" class="btn btn-primary">Add Candidate</button>
            </div>
        </form>
    </div>
    <% include partials/footer %>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.17.0/jquery.validate.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script>
    <script>
        $('.inputs').keydown(function (e) {
            if (e.which === 13) {
                var index = $('.inputs').index(this) + 1;
                $('.inputs').eq(index).focus();
            }
        });

        var container = $('#formContainer');//,

        function scrollToNextElement(nextElement) {
            var scrollTo = $('#' + nextElement);
            container.animate({scrollTop: scrollTo.offset().top - container.offset().top +
            container.scrollTop()});
        }

        var keys = document.getElementsByTagName("input");
        var rules = {};

        for (var index = 0; index < keys.length; index++) {
            var key = keys[index].name;
            rules[key] = "required";
        }

        $("#addCandidate").validate({
            ignore: "",
            success: function(label,element) {
                //element.find("input").css( "border", "solid green 1px" );
                element.style.border= "solid green 1px" ;
            },
            //debug: true,
            rules: rules,
            messages: {

            },
            errorElement: "div",
            wrapper: "div",  // a wrapper around the error message
            errorPlacement: function(error, element) {
                element.before(error);

                //element.parent("div").find("a").css( "border", "solid red 1px" );
                element.css( "border", "solid red 1px" );
                offset = element.offset();
                error.css('left', offset.left);
                error.css('bottom', offset.top - element.outerHeight());
            },
            focusInvalid: false,
            invalidHandler: function(form, validator) {
                if (!validator.numberOfInvalids())
                    return;

            },
            submitHandler: function (form) {
                var formData =  JSON.stringify($('#addCandidate').serializeArray());
                var cid = getCid();
                var newUserDate = new Date();
                _LTracker.push({
                    'text': 'New candidate added',
                    'userData': formData,
                    'userType': 'candidate',
                    'date': newUserDate.toString(),
                    'cid': cid
                });
                mixpanel.track('New candidate added', { 'userData': formData, 'userType': 'candidate', 'date': newUserDate.toString(), 'cid': cid });

                /*$.ajax({
                    url:'/addCandidate',
                    type:'post',
                    data:$('#addCandidate').serialize() ,//+ fileData,
                    async: false,
                    success:function(){
                        //console.log(form.user_id.value);
                        mixpanel.track('New Candidate added', {'uid': form.user_id.value/* candidate/employee });

                        // TODO: scrollTo block user authentication display
                    }
                });*/
                form.submit();
            }
        });

        function getCid() {
            var urlPath = window.location.pathname;
            var cid = urlPath.split('/');
            return cid[2];
        }
    </script>

</body>
</html>
